객체지향의 핵심은 역할, 책임, 협력
”협력하는 객체들의 공동체 창조”가 본질

어떤 역할과 책임이 필요한지 먼저 고민

# 01 협력

## 영화 예매 시스템 돌아보기

- 협력: 기능 구현을 위해 객체들이 수행하는 상호작용
- 책임: 협력에 참여하기 위해 수행하는 로직
- 역할: 협력 안에서 수행하는 객체의 책임이 모여 구성

## 협력

- 자율적인 객체들끼리 메시지를 전송하여 협력
    - 처리 방법은 수신 객체가 결정
    - 내부 구현 캡슐화로 객체 자율적으로 만들 수 있다
- 객체들 사이의 협력을 구성하는 요청, 응답의 흐름으로 기능 구현

## 협력이 설계를 위한 문맥을 결정한다

- 객체의 행동은 객체가 참여하는 협력이 결정
    - 협력에 필요하기 때문에 객체가 존재, 협력에 필요한 행동을 보유하기 때문에 협력에 참여
- 객체의 상태는 행동을 수행하는 데 필요한 정보로 결정

# 02 책임

## 책임이란 무엇인가

책임 = 협력에 참여하기 위해 객체가 수행하는 행동

- 하는 것 + 아는 것으로 구성
- 책임이 메시지보다 추상적이고 더 큰 개념
- 객체에게 얼마나 적절한 책임을 할당하느냐가 설계 품질 결정

## 책임 할당

- 객체 지향 설계는 협력에 필요한 메시지와 메시지에 적절한 객체를 선택하는 반복적 과정
    - 협력 설계의 출발은 시스템이 사용자에게 제공할 기능을 시스템의 책임 중 하나로 바라보는 것
- 정보 전문가 패턴 = 책임 수행에 필요한 정보를 가장 잘 알고있는 전문가에게 책임을 할당하는 것
    - 항상 좋은 방법은 아니지만 자율적인 객체를 만들 가능성이 높아지는 방법

## 책임 주도 설계

책임 주도 설계(Responsibility-Driven Design, RDD): 책임을 찾은 후 적절한 객체에게 책임을 할당하는 설계 방법

1. 시스템 책임 파악
2. 시스템 책임을 더 작은 책임으로 분할
3. 분할된 책임을 적절한 객체 또는 역할에게 할당
4. 객체가 책임을 수행하는 중에 다른 객체 도움이 필요할 경우 이를 책임질 적절한 객체 또는 역할 찾기
5. 해당 객체 또는 역할에게 책임 할당 → 두 객체 협력

## 메시지가 객체를 결정한다

객체가 메시지 선택 X, 메시지가 객체를 선택 O

- minimal interface: 꼭 필요한 크기의 인터페이스
- abstract interface: 무엇을 수행할지에 초점 맞춘 인터페이스

## 행동이 상태를 결정한다

행동이 중요, 상태는 행동을 위한 재료일 뿐

- 상태에 초점을 맞추면 캡슐화 저해됨(데이터 주도 설계)

# 03 역할

## 역할과 협력

역할 = 객체가 특정 협력 안에서 수행하는 책임의 집합

- 협력 모델링 시에는 특정 객체가 아닌 역할에게 책임을 할당한다고 생각하는게 좋다

## 유연하고 재사용 가능한 협력

역할이라는 개념으로 유연, 재사용 가능한 협력을 얻을 수 있다

- 역할을 협력 내에서 여러 객체를 끼워 넣을 일종의 슬롯처럼 생각할 수 있다
    - 구체적인 객체를 포괄하는 추상화
- 동일한 책임을 수행하는 역할을 기반으로 여러 협력을 하나로 통합할 수 있다

## 객체 대 역할

협력을 구체적인 객체가 아니라 추상적인 역할의 관점에서 설계하면 유연, 재사용 가능해진다

- 책임을 수행하는 대상이 한 종류라면 간단하게 객체로 간주
- 설계 초반에는 책임과 협력의 큰 그림 탐색이 중요, 역할 - 객체의 구분은 그렇게 중요하지 않을 수 있다
    - 정확히 책임 수행의 후보가 무엇인지 초반에는 중요하지 않다
    - 다양한 객체가 참여하는게 확실하다면 역할, 그렇지 않다면 구체적인 객체로 시작한 후 정제해나가는게 좋다

## 역할과 추상화

추상화를 이용한 설계의 장점

1. 중요한 정책을 상위 수준에서 단순화
2. 좀 더 유연

역할을 객체의 추상화로 볼 수 있기 때문에, 이런 장점은 협력의 관점에서 역할에도 적용될 수 있음

1. 구체적인 객체들이 가지는 복잡성 제거하고 단순화해서 표현
2. 동일한 역할을 수행하는 객체들은 서로 대체 가능

## 배우와 배역

*연극 안에서 극본에 따라 배역을 연기하는 배우*

- 배역은 배우가 특정 연극에서 연기하는 역할
- 배역은 연극 상영동안에만 존재하는 일시적 개념
- 서로 다른 배우들이 동일한 배역 연기할 수 있다
- 하나의 배우가 다양한 연극에서 서로 다른 배역을 연기할 수 있다’

*협력 안에서 코드에 따라 역할을 수행하는 객체*

- 역할은 특정 협력에 참여해서 책임을 수행하는 객체의 일부
- 역할은 객체가 참여하는 동안에만 존재하는 일시적 개념
    - 모양, 구조에 의해 정의 X, 오직 시스템 문맥 안에서 무엇을 하는지 O
    - 객체의 페르소나
- 동일 역할 수행하는 객체들은 서로 대체 가능
- 객체는 여러 협력에 참여하면서 다양한 역할 수행
    - 특정 협력 안에서는 오직 하나의 역할
    - 같은 객체여도 참여하는 협력에 따라 얼굴은 바뀐다
    - 객체는 다수 역할을 보유할 수 있지만 특정 협력은 한 가지 역할만 본다
